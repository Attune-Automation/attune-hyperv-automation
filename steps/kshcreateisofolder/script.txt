$ISO_FOLDER = "C:\Users\Public\Documents\Hyper-V\isos"
$KICKSTART_FOLDER = "C:\Users\Public\Documents\Hyper-V\isos\kickstart_{targetServer.fqn}"

if (Test-Path $ISO_FOLDER) {
    Write-Host "ISO folder $ISO_FOLDER exists, good"
} else {
    Write-Host "ISO folder $ISO_FOLDER deos not exist, creating"
    New-Item $ISO_FOLDER -ItemType Directory
    if (Test-Path $ISO_FOLDER) {
        Write-Host "ISO folder $ISO_FOLDER created."
    } else {
        Write-Error "Failed to create ISO folder $ISO_FOLDER" -ErrorAction Stop
    }
}

if (Test-Path $KICKSTART_FOLDER) {
  Write-Host "Kickstart folder $KICKSTART_FOLDER exists, good"
} else {
  Write-Host "Kickstart folder $KICKSTART_FOLDER deos not exist, creating"
  New-Item $KICKSTART_FOLDER -ItemType Directory
  if (Test-Path $KICKSTART_FOLDER) {
    Write-Host "Kickstart folder $KICKSTART_FOLDER created."
  }
}